# Git Ignore Guide for Terraform Projects

## Overview

This document explains the `.gitignore` file used in the Terraform project. The `.gitignore` file specifies intentionally untracked files that Git should ignore.

**Location**: `.gitignore` (root of repository)

---

## Why .gitignore is Important

### Security Risks of NOT Ignoring Files

❌ **If you commit to Git without proper .gitignore:**
- AWS credentials exposed to malicious actors
- SSH private keys compromised
- Terraform state files with sensitive data visible
- Database passwords leak
- API keys exposed
- Compliance violations (PCI, HIPAA, SOC2)
- Risk of account takeover and infrastructure compromise

### Files That Must NEVER Be Committed

| File Type | Why | Consequence |
|-----------|-----|-------------|
| `terraform.tfstate` | Contains all resource details and secrets | Entire infrastructure exposed |
| `.tfvars` files | Contains variable values (passwords, keys) | Credentials compromised |
| AWS credentials | AWS access/secret keys | Account takeover |
| SSH private keys | Used to connect to instances | Unauthorized access |
| Environment files `.env` | Contains sensitive configuration | All secrets exposed |
| `.aws/credentials` | AWS authentication | AWS account compromise |

---

## .gitignore Structure

### Section 1: Terraform Core Files

```gitignore
# Local .terraform directories
**/.terraform/*

# .tfstate files
*.tfstate
*.tfstate.*
*.tfstate.backup

# Crash log files
crash.log
crash.*.log
```

**Purpose**: Ignore Terraform working directory and state files

**What Gets Ignored:**
- `.terraform/` - Downloaded modules and provider plugins
- `terraform.tfstate` - Current state file
- `terraform.tfstate.backup` - Previous state backup
- `crash.log` - Terraform crash logs

**Why**: 
- State files contain sensitive information
- `.terraform/` is auto-generated during `terraform init`
- Crash logs may contain secrets

---

### Section 2: Terraform Variable Files

```gitignore
# Exclude all .tfvars files, which contain sensitive data
*.tfvars
*.tfvars.json
!example.tfvars
```

**Purpose**: Ignore environment-specific variable files

**What Gets Ignored:**
- `dev.tfvars` - Development variables
- `prod.tfvars` - Production variables
- Any `.tfvars` or `.tfvars.json` files

**Exception:**
- `!example.tfvars` - DO track example file

**Why**:
- .tfvars files contain sensitive values
- Each environment has different secrets
- Example file helps others understand structure

**Example .tfvars structure you should track:**
```hcl
# example.tfvars
region         = "us-east-1"
environment    = "dev"
instance_type  = "t2.micro"
# ❌ DON'T include: db_password = "actual-password"
# ✅ DO show: # db_password = "set in secrets manager"
```

---

### Section 3: Override Files

```gitignore
# Ignore override files
override.tf
override.tf.json
*_override.tf
*_override.tf.json

# Include override files you do want tracked
!example_override.tf
```

**Purpose**: Ignore local override files that shouldn't be shared

**What Gets Ignored:**
- `override.tf` - Local-only overrides
- `prod_override.tf` - Environment-specific overrides
- Any `*_override.tf` or `*_override.tf.json`

**When to Use:**
```hcl
# main.tf
resource "aws_instance" "web" {
  instance_type = "t2.micro"
}

# prod_override.tf (local, not committed)
resource "aws_instance" "web" {
  instance_type = "t2.large"  # Override for production
}
```

---

### Section 4: CLI Configuration

```gitignore
# Ignore CLI configuration files
.terraformrc
terraform.rc
.terraform.lock.hcl
```

**Purpose**: Ignore Terraform CLI configuration

**What Gets Ignored:**
- `.terraformrc` - Local Terraform configuration
- `terraform.rc` - Alternative config filename
- `.terraform.lock.hcl` - Provider lock file (optional to ignore)

**Note About Lock File:**
- **Option A**: Ignore lock file (not recommended for teams)
  ```
  .terraform.lock.hcl
  ```
- **Option B**: Track lock file (RECOMMENDED for teams)
  ```
  # Remove from .gitignore to track
  # Ensures all team members use same provider versions
  ```

**Best Practice**: TRACK `.terraform.lock.hcl` in team environments

---

### Section 5: Plan Files

```gitignore
# Ignore plan files
*.tfplan
```

**Purpose**: Ignore saved Terraform execution plans

**What Gets Ignored:**
- `dev.tfplan` - Saved plan files
- `main.tfplan` - Local plan files

**When to Ignore:**
- Large local test plans
- Plans with sensitive data exposed

**When to Track:**
- Important plan for audit trail (review case-by-case)

---

### Section 6: IDE and Editor Files

```gitignore
# IDE and Editor files
.vscode/
.idea/
*.swp
*.swo
*~
.DS_Store
Thumbs.db
*.iml
*.sublime-project
*.sublime-workspace
.netrc
```

**Purpose**: Ignore IDE-specific configuration

**What Gets Ignored:**
- `.vscode/` - VS Code settings
- `.idea/` - JetBrains IDE (IntelliJ, WebStorm)
- `*.swp`, `*.swo` - Vim swap files
- `*~` - Emacs backup files
- `.DS_Store` - macOS folder metadata
- `Thumbs.db` - Windows folder thumbnails
- `*.iml` - IntelliJ module files
- `.netrc` - Shell authentication file

**Why**: These are editor-generated and vary per developer

---

### Section 7: Environment Files

```gitignore
# Environment files
.env
.env.local
.env.*.local
```

**Purpose**: Ignore environment-specific configuration

**What Gets Ignored:**
- `.env` - Default environment file
- `.env.local` - Local overrides
- `.env.dev.local` - Dev-specific overrides
- `.env.prod.local` - Prod-specific overrides

**Why**: Often contain API keys, passwords, secrets

---

### Section 8: OS Specific Files

```gitignore
# OS specific files
.DS_Store
.DS_Store?
._*
.Spotlight-V100
.Trashes
ehthumbs.db
Thumbs.db
*.iso
```

**Purpose**: Ignore operating system generated files

**What Gets Ignored:**
- `.DS_Store` - macOS (duplicate but OK)
- `Thumbs.db` - Windows (duplicate but OK)
- `.Spotlight-V100` - macOS Spotlight index
- `.Trashes` - macOS trash metadata
- `ehthumbs.db` - Windows Explorer thumbnails

**Why**: OS-generated, shouldn't be in version control

---

### Section 9: Log Files

```gitignore
# Logs
*.log
*.logs
debug.log
terraform.log
terraform-debug.log
*.tar.gz
```

**Purpose**: Ignore log files

**What Gets Ignored:**
- `*.log` - Any log files
- `debug.log` - Debug logs
- `terraform.log` - Terraform execution logs
- `*.tar.gz` - Compressed logs

**Why**: 
- Logs can contain sensitive information
- Logs shouldn't be version controlled
- Logs are regenerated on each run

---

### Section 10: Temporary Files

```gitignore
# Temporary files
tmp/
temp/
*.tmp
*.bak
*.backup
```

**Purpose**: Ignore temporary working files

**What Gets Ignored:**
- `tmp/`, `temp/` - Temporary directories
- `*.tmp`, `*.bak`, `*.backup` - Backup files

**Why**: These are transient and shouldn't be committed

---

### Section 11: SSH and AWS Credentials

```gitignore
# SSH keys
id_rsa
id_rsa.pub
*.pem
*.key
*.pub

# AWS credentials
.aws/
credentials
.aws/credentials
```

**Purpose**: Ignore authentication credentials (CRITICAL)

**What Gets Ignored:**
- `id_rsa` - SSH private key
- `*.pem` - Certificate files
- `.aws/credentials` - AWS authentication file
- `.aws/` - AWS configuration directory

**⚠️ CRITICAL SECURITY**: Never commit these files!

**If Accidentally Committed:**
```bash
# Revoke the credential immediately
# 1. In AWS Console - deactivate access key
# 2. Rotate SSH keys
# 3. Rewrite git history (advanced)
git filter-branch --tree-filter 'rm -f id_rsa' HEAD
```

---

### Section 12: Backup Files

```gitignore
# Backup files
*.backup
backup-*.tfstate
backup-*/
state-backup/
```

**Purpose**: Ignore state file backups created locally

**What Gets Ignored:**
- `backup-20240214.tfstate` - Local state backups
- `backup-*/` - Backup directories
- Any `*.backup` files

**Why**:
- Backups are local recovery copies
- Should use Git history or remote state for recover
- Reduces repository bloat

---

### Section 13: Terraform Cloud/Enterprise

```gitignore
# Terraform Cloud/Enterprise
.terraformignore
terraform.cloud
```

**Purpose**: Ignore cloud-specific configuration

**What Gets Ignored:**
- `.terraformignore` - Cloud upload ignore file
- `terraform.cloud` - Cloud configuration

---

### Section 14: JSON Outputs

```gitignore
# JSON outputs
outputs.json
*.output.json
```

**Purpose**: Ignore generated output files

**What Gets Ignored:**
- `outputs.json` - Terraform outputs in JSON
- Generated JSON files with sensitive data

**Why**: Outputs may contain sensitive information

---

### Section 15: Python Files

```gitignore
# Python files (if using Python scripts)
__pycache__/
*.py[cod]
*$py.class
*.so
venv/
ENV/
env/
```

**Purpose**: Ignore Python-specific files

**What Gets Ignored:**
- `__pycache__/` - Python cache directory
- `*.pyc`, `*.pyo` - Compiled Python
- `venv/`, `ENV/`, `env/` - Virtual environments

**When Used**: If using Python scripts with Terraform

---

### Section 16: Node Files

```gitignore
# Node modules (if using Node for scripts)
node_modules/
npm-debug.log
yarn-error.log
```

**Purpose**: Ignore Node.js dependencies

**When Used**: If using Node.js scripts with Terraform

---

### Section 17: IDE Settings (Keep Some)

```gitignore
# IDE specific directories
.vscode/*
!.vscode/settings.json
!.vscode/tasks.json
!.vscode/launch.json
!.vscode/extensions.json
.idea/*
!.idea/.gitignore
*.code-workspace
```

**Purpose**: Ignore IDE files but track some helpful configs

**Explanation**:
- `.vscode/*` - Ignore all VS Code files
- `!.vscode/settings.json` - EXCEPT track settings (team standards)
- `!.vscode/tasks.json` - EXCEPT track tasks (helpful for team)
- `!.vscode/launch.json` - EXCEPT track debug config
- `!.vscode/extensions.json` - EXCEPT track recommended extensions

**Benefits**:
- Team can share editor configurations
- Consistent code formatting for all developers
- Recommended extensions for team

---

## Usage Examples

### Check What Would Be Ignored

```bash
# See what files would be ignored
git check-ignore -v *

# Output example:
# .env          	.gitignore:40:*.env
# terraform.log 	.gitignore:45:*.log
# .vscode       	.gitignore:50:.vscode/
```

### Check What's Tracked

```bash
# List tracked files
git ls-files

# List files matching pattern
git ls-files | grep tfvars
```

### Remove Accidentally Committed Files

```bash
# Remove file from tracking but keep locally
git rm --cached filename
git commit -m "Remove accidentally tracked file"

# Then add to .gitignore
echo "filename" >> .gitignore
```

### Force Add Ignored File (if needed)

```bash
# Add ignored file explicitly
git add -f ignored-file.txt
```

---

## Best Practices

### ✅ DO

- **Update .gitignore first** before committing sensitive files
- **Commit .gitignore** to repository so all team members use it
- **Review before committing** - Check `git status` carefully
- **Use .example files** - Create example files showing structure
- **Document exclusions** - Add comments explaining why files are ignored
- **Keep sensitive data separate** - Use environment variables or secret managers
- **Use pre-commit hooks** - Prevent accidental commit of secrets

### ❌ DON'T

- **Don't ignore .gitignore** - It must be committed
- **Don't use .gitignore as substitute for secrets management** - Use AWS Secrets Manager, HashiCorp Vault, etc.
- **Don't commit secrets** - Even if later added to .gitignore, they remain in Git history
- **Don't over-ignore** - Only ignore necessary files
- **Don't ignore lock files** (`.terraform.lock.hcl`) - Track for team consistency
- **Don't change .gitignore per-environment** - Should be same for all developers

---

## Pre-commit Hook to Prevent Secrets

Install a pre-commit hook to detect secrets:

```bash
# Install pre-commit
pip install pre-commit

# Install Git hooks
pre-commit install

# Test it
pre-commit run --all-files
```

Create `.pre-commit-config.yaml`:

```yaml
repos:
  - repo: https://github.com/Yelp/detect-secrets
    rev: v1.4.0
    hooks:
      - id: detect-secrets
        args: ['--baseline', '.secrets.baseline']

  - repo: https://github.com/terraform-docs/terraform-docs
    rev: v0.16.0
    hooks:
      - id: terraform-fmt
      - id: terraform-docs
```

---

## File Organization Strategy

### Recommended Structure for Sensitive Data

```
terraform-project/
├── .gitignore                 # (tracked) - ignore rules
├── .gitignore-guide.md        # (tracked) - this guide
├── example.tfvars             # (tracked) - example config
│
├── dev.tfvars                 # (ignored) - dev secrets
├── prod.tfvars                # (ignored) - prod secrets
│
├── main.tf                    # (tracked) - infrastructure
├── variables.tf               # (tracked) - variable definitions
├── outputs.tf                 # (tracked) - outputs
│
├── terraform.tfstate          # (ignored) - state file
├── terraform.tfstate.backup   # (ignored) - state backup
│
├── .terraform/                # (ignored) - plugins
├── .terraform.lock.hcl        # (tracked) - lock file (optional)
│
└── .vscode/
    ├── settings.json          # (tracked) - team settings
    └── extensions.json        # (tracked) - recommended extensions
```

---

## Verification Checklist

Before pushing to repository:

```powershell
# ✓ Check for untracked files
git status

# ✓ Verify .gitignore rules
git check-ignore -v *

# ✓ Check for secrets in staged files
# Look for aws_access_key, password, secret_key, etc.
git diff --cached | findstr /i "password|secret|token|key"

# ✓ List files that would be tracked
git ls-files --others --exclude-standard

# ✓ Safe to commit
git add .
git commit -m "Your message"
```

---

## Summary

### What To Track (✓)
- `.gitignore` - Ignore rules
- `*.tf` files - Terraform configs
- `example.tfvars` - Example config template
- `variables.tf` - Variable definitions
- `outputs.tf` - Output definitions
- `README.md` - Documentation
- `.terraform-docs.yaml` - Documentation config
- `.github/workflows/` - CI/CD workflows
- `.vscode/settings.json` - Team editor settings
- `.terraform.lock.hcl` - Provider lock file

### What NOT To Track (✗)
- `*.tfvars` (except example) - Sensitive values
- `terraform.tfstate*` - State files
- `.terraform/` - Downloaded files
- `.env*` - Environment files
- `.aws/` - AWS credentials
- SSH keys (`*.pem`, `id_rsa`) - Private keys
- IDE-specific configs (.idea, `.vscode/`) - Personal
- `*.log` files - Generated logs
- Temporary files - Transient data

---

**Version**: 1.0  
**Last Updated**: February 14, 2026  
**Status**: Production Ready
